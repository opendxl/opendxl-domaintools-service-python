
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Basic PhishEye Example &#8212; DomainTools DXL Python Service 0.2.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Basic PhishEye Term List Example" href="basicphisheyetermlistexample.html" />
    <link rel="prev" title="Basic Parsed Whois Example" href="basicparsedwhoisexample.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="basicphisheyetermlistexample.html" title="Basic PhishEye Term List Example"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="basicparsedwhoisexample.html" title="Basic Parsed Whois Example"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">DomainTools DXL Python Service 0.2.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="basic-phisheye-example">
<h1>Basic PhishEye Example<a class="headerlink" href="#basic-phisheye-example" title="Permalink to this headline">¶</a></h1>
<p>This sample invokes and displays the results of a DomainTools &quot;PhishEye&quot; via DXL.</p>
<dl class="docutils">
<dt>For more information see:</dt>
<dd><a class="reference external" href="https://www.domaintools.com/resources/api-documentation/phisheye/">https://www.domaintools.com/resources/api-documentation/phisheye/</a></dd>
</dl>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The samples configuration step has been completed (see <a class="reference internal" href="sampleconfig.html"><span class="doc">Samples Configuration</span></a>)</li>
<li>The DomainTools API DXL service is running (see <a class="reference internal" href="running.html"><span class="doc">Running</span></a>)</li>
</ul>
</div>
<div class="section" id="running">
<h2>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h2>
<p>To run this sample execute the <code class="docutils literal notranslate"><span class="pre">sample/basic/basic_phisheye_example.py</span></code> script as follows:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">sample</span><span class="o">/</span><span class="n">basic</span><span class="o">/</span><span class="n">basic_phisheye_example</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div></blockquote>
<p>The output should appear similar to the following:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;term&quot;</span><span class="p">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span>
      <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-11-01&quot;</span><span class="p">,</span>
      <span class="s2">&quot;domains&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;domain&quot;</span> <span class="p">:</span> <span class="s2">&quot;firstexample-apple.com&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tld&quot;</span><span class="p">:</span> <span class="s2">&quot;com&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-10-30&quot;</span><span class="p">,</span>
          <span class="s2">&quot;registrant_email&quot;</span><span class="p">:</span> <span class="s2">&quot;somebody@example.com&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name_servers&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;ns1.example.com&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ns2.example.com&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;registrar_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Some Registrar 1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;risk_score&quot;</span><span class="p">:</span> <span class="mi">88</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;appeltypoexample.com&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tld&quot;</span><span class="p">:</span> <span class="s2">&quot;com&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-10-31&quot;</span><span class="p">,</span>
          <span class="s2">&quot;registrant_email&quot;</span><span class="p">:</span> <span class="s2">&quot;somebody2@example.com&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ip_addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;192.0.2.100&quot;</span><span class="p">,</span>
              <span class="s2">&quot;country_code&quot;</span><span class="p">:</span> <span class="s2">&quot;US&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;192.0.2.101&quot;</span><span class="p">,</span>
              <span class="s2">&quot;country_code&quot;</span><span class="p">:</span> <span class="s2">&quot;US&quot;</span>
            <span class="p">}</span>
          <span class="p">],</span>
          <span class="s2">&quot;name_servers&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;ns57.domaincontrol.com&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ns58.domaincontrol.com&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;registrar_name&quot;</span><span class="p">:</span> <span class="s2">&quot;GoDaddy.com, LLC&quot;</span><span class="p">,</span>
          <span class="s2">&quot;risk_score&quot;</span><span class="p">:</span> <span class="mi">24</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;thirdexample-apple.ru&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tld&quot;</span><span class="p">:</span> <span class="s2">&quot;ru&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2014-09-23&quot;</span><span class="p">,</span>
          <span class="s2">&quot;registrant_email&quot;</span><span class="p">:</span> <span class="s2">&quot;somebody3@example.com&quot;</span><span class="p">,</span>
          <span class="s2">&quot;registrar_name&quot;</span><span class="p">:</span> <span class="s2">&quot;1API GmbH&quot;</span><span class="p">,</span>
          <span class="s2">&quot;risk_score&quot;</span><span class="p">:</span> <span class="mi">33</span>
        <span class="p">},</span>
        <span class="o">...</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>The received results are displayed.</p>
</div>
<div class="section" id="details">
<h2>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h2>
<p>The majority of the sample code is shown below:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the client</span>
<span class="k">with</span> <span class="n">DxlClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="c1"># Connect to the fabric</span>
    <span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Connected to DXL fabric.&quot;</span><span class="p">)</span>

    <span class="n">request_topic</span> <span class="o">=</span> <span class="s2">&quot;/opendxl-domaintools/service/domaintools/phisheye&quot;</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">request_topic</span><span class="p">)</span>
    <span class="n">MessageUtils</span><span class="o">.</span><span class="n">dict_to_json_payload</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;apple&quot;</span><span class="p">})</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">sync_request</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">message_type</span> <span class="o">!=</span> <span class="n">Message</span><span class="o">.</span><span class="n">MESSAGE_TYPE_ERROR</span><span class="p">:</span>
        <span class="n">res_dict</span> <span class="o">=</span> <span class="n">MessageUtils</span><span class="o">.</span><span class="n">json_payload_to_dict</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">MessageUtils</span><span class="o">.</span><span class="n">dict_to_json</span><span class="p">(</span><span class="n">res_dict</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error invoking service with topic &#39;</span><span class="si">{}</span><span class="s2">&#39;: </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">request_topic</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">error_message</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">error_code</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<p>After connecting to the DXL fabric, a <cite>request message</cite> is created with a topic that targets the &quot;phisheye&quot; method
of the DomainTools API DXL service.</p>
<p>The next step is to set the <cite>payload</cite> of the request message. The contents of the payload include the <cite>query</cite> parameter
to report on.</p>
<p>From the DomainTools <a class="reference external" href="https://www.domaintools.com/resources/api-documentation/phisheye/">PhishEye Documentation</a>:</p>
<blockquote>
<div><cite>&quot;The PhishEye API provides programmatic access to daily monitor results from the DomainTools PhishEye product.
The PhishEye API is only available via our Enterprise Solutions team, and is not included in a membership.&quot;</cite></div></blockquote>
<p>The final step is to perform a <cite>synchronous request</cite> via the DXL fabric. If the <cite>response message</cite> is not an error
its contents are formatted and displayed.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Basic PhishEye Example</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#running">Running</a></li>
<li><a class="reference internal" href="#details">Details</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="basicparsedwhoisexample.html"
                        title="previous chapter">Basic Parsed Whois Example</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="basicphisheyetermlistexample.html"
                        title="next chapter">Basic PhishEye Term List Example</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/basicphisheyeexample.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="basicphisheyetermlistexample.html" title="Basic PhishEye Term List Example"
             >next</a> |</li>
        <li class="right" >
          <a href="basicparsedwhoisexample.html" title="Basic Parsed Whois Example"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">DomainTools DXL Python Service 0.2.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, McAfee LLC.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>